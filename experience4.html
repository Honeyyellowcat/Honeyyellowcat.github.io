<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Felicity: SPACE Lab</title>
    <!-- Icon and Font -->
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-rounded/css/uicons-regular-rounded.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <link rel="icon" href="assets/img/F.png" />
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.2.4/swiper-bundle.css">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Parallax JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/parallax/3.1.0/parallax.min.js"></script>
    <!-- Main CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
    <div class="header">
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="current.html">Current Work </a></li>
                <li><a href="experience.html">Experiences</a></li>
            </ul>
        </nav>
    </div>

    <div class="wrapper">
        <h1 class="text-pink font-bold select-none uppercase text-3xl md:text-5xl lg:text-6xl padded-heading">SPACE Lab: Pulsed Plasma Thruster Stand</h1>
        <div class="image-container">
            <img src="assets/img/PPT_2.jpg" alt="Pulsed Plasma Thruster Stand">
        </div>
        <div class="text-container">
            <h2 class="text-3xl text-pink">Summary:</h2>
            <ul>
                <li>Python: nidaqmx & PySerial to record and calibrate deflection, ensuring accuracy within embedded systems
                    Embedded serial communication with Arduino UNO using PySerial for precise motor control in our system
                    SPACE Labs vacuum chambers are utilized to test and explore plasma physics in PPT electric thrusters
                    ANSYS/FEA software to analyze and optimize overall designs for enhanced performance and efficiency
                    Collaborated in the strategic optimization and design of the thruster stand using 3D printing technology</li>
            </ul>
            <ul class="text-2xl ">
                <li>1. Preliminary Design Review (PDR): <a href="doc/CDR.pdf" target="_blank">Here</a></li>
                <li>2. Critical Design Review (CDR): <a href="doc/PDR.pdf" target="_blank">Here</a></li>
                <li>3. Test Readyness Review (TRR): <a href="doc/TRR.pdf" target="_blank">Here</a></li>
                <li>4. System Test Procedure: <a href="#" target="_blank">Will Update</a></li>
                <li>4. Design Document: <a href="#" target="_blank">Will Update</a></li>
                <li>4. Aceptance Review (AR): <a href="#" target="_blank">Will Update</a></li>
            </ul>
            <h2 class="text-2xl text-pink">Mission Objective:</h2>
                <ul>
                    <p>To design and build an operational, minimally conductive, inverted pendulum test stand for the University of Washington’s SPACE Lab. The stand should accurately resolve impulses from pulsed plasma thrusters within a range of 10 μN*s to 100 mN*s.</p>
                </ul>
            <h3 class="text-2xl text-pink">Chamber Interface</h3>
            <ul>
                <li>- Base of adjustable feet will be made of rubber to isolate stands from external vibrations and protect chamber walls.</li>
                <li>- Once the final stand is designed, the material and geometry of rubber isolators can be chosen to isolate vibration. Vibration frequency at the chamber wall will also have to be measured.</li>
            </ul>
            <h3 class="text-2xl text-pink">Thrust Measurement:</h3>
            <ul>
                <li>The design parameters for the thruster's flexures are established based on a thrust range of 10 μN to 100 mN and a 
                    thruster position height of 0.25 m, necessitating spring constants between 0.700 Nm < k < 7.81E4 Nm for an 8 kg 
                    thruster with a rangefinder precision of 10E-6 m. Opting for an 8 flexure design, the DawgStar’s PPT configuration 
                    (5 kg) with an average thrust of 5.68E-5 N and a moment arm of 0.25 m corresponds to k = 42.8 N*m. Ansys FEA was 
                    conducted for a single leg of the pendulum due to software limitations on the student version, revealing a total 
                    displacement of 0.0227 inches (0.576 mm) using 0.01-inch thick spring steel flexure. The IL-100 rangefinder offers 
                    a minimum resolution of 60 μm, and Requirement St.7 is fulfilled at the low end of the scale, with flexibility to 
                    adjust flexure thickness for the upper end. A simple design utilizing 4 bolts secures the flexures in place, 
                    facilitating easy removal and installation when the test stand is fully assembled. Flexures of various thicknesses, 
                    ranging from 0.01 inches to 0.6 inches, will be manufactured to meet the design requirements, ensuring the fulfillment 
                    of Requirement St.8 through this strategic approach.
                </li>
            </ul>
            <h2 class="text-2xl text-pink">GUI (DAQ)</h2>
            <ul>
                <li>The deflection data is initially recorded using ni-daqmx, and the acquired data is stored in the global variable 
                    deflection_data. This raw data is then processed to derive thrust measurements by calibrating with known force and 
                    deflection values, and the resulting data is stored in global variables. Subsequently, a graphical display is generated 
                    to visualize the deflection measurements along with their uncertainties, represented by error bars. Matplotlib is 
                    utilized for this graphical representation. Additionally, export options are provided for both figures (saved as .png 
                    files) and raw data (exported as .csv files), facilitated by pandas.
                </li>
            </ul>
        </div>

            <div class="text-container">
                <h3 class="text-2xl text-pink">Calibration and Testing Code:</h3> 
                <pre class="code-box small">
                    <code>
                        import pandas as pd
                        import matplotlib.pyplot as plt
                        import seaborn as sns
                        from sklearn.linear_model import LinearRegression
    
                        sns.set(style="whitegrid")
    
                        def detect_max_voltage(csv_files, voltage_column, start_row):
                            max_voltages = []  # List to store maximum voltages
                            
                            for csv_file in csv_files:
                                print("Processing file:", csv_file)
                                df = pd.read_csv(csv_file)  # Load CSV file into a DataFrame
                                voltage_data = df.loc[start_row:, voltage_column]  # Select the 'CH4' column starting from row 17
                                voltage_data = pd.to_numeric(voltage_data, errors='coerce')  # Convert voltage data to numeric type
                                voltage_data.dropna(inplace=True)  # Drop rows with NaN values in the voltage data
                                max_voltage = voltage_data.max()  # Find maximum voltage value
                                max_voltages.append(max_voltage)  # Append maximum voltage to the list
                                print("Maximum voltage:", max_voltage)  # Print maximum voltage value
                                print()
    
                            return max_voltages
    
                        def plot_vmax_vs_impulses(known_impulses, max_voltages, subplot_index):
                            plt.subplot(2, 1, subplot_index)  # Use the provided subplot index
                            plt.plot(known_impulses, max_voltages, marker='o', linestyle='-', color='#ff5733', linewidth=3, markersize=10)  # Adjust line and marker styles
                            plt.xlabel('Number of Known Impulse Plot', fontsize=14, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.ylabel('Maximum Voltage', fontsize=14, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.title('Linear Impulses', fontsize=16, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.grid(True, linestyle='--', alpha=0.7, color='#aaaaaa')  # Adjust grid style
                            plt.xticks(fontsize=12, color='#555555')  # Adjust tick labels
                            plt.yticks(fontsize=12, color='#555555')  # Adjust tick labels
                            plt.tight_layout()  # Adjust layout
                            plt.gca().set_facecolor('#f0f0f0')  # Set background color of plot face
    
                        # I_bit = v_max / c ------------------------------------------------------------------------------------------------------------------------------
                        def plot_ibit_vs_vmax(max_voltages, slope, subplot_index):
                            plt.subplot(2, 1, subplot_index)  # Use the provided subplot index
                            bit_impulses = [v / slope for v in max_voltages]
                            plt.plot(bit_impulses, max_voltages, marker='s', linestyle='--', color='blue', linewidth=2, markersize=8)  # Adjust line and marker styles
                            plt.xlabel('Time (s)', fontsize=14, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.ylabel('Maximum Voltage', fontsize=14, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.title('Impulse Plot', fontsize=16, fontweight='bold', color='#333333')  # Adjust font size and style
                            plt.grid(True, linestyle='--', alpha=0.7, color='#aaaaaa')  # Adjust grid style
                            plt.xticks(fontsize=12, color='#555555')  # Adjust tick labels
                            plt.yticks(fontsize=12, color='#555555')  # Adjust tick labels
                            plt.tight_layout()  # Adjust layout
                            plt.gca().set_facecolor('#f0f0f0')  # Set background color of plot face
    
                        # File
                        csv_files = ['C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0298.csv', 'C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0299.csv', 'C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0299_2.csv']
                        new_csv_files = ['C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0298_I_bit.csv', 'C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0299_I_bit.csv', 'C:/Users/every/OneDrive/Desktop/CODE/4 - PPT/CALI/T0299_2.csv']
    
                        voltage_column = "CH4"  # Adjust column name as needed
                        start_row = 17  # Adjust the starting row as needed
    
                        known_impulses = [1, 2, 3, 4]  # Extend known impulses to 3 and 4
    
                        # Detect maximum voltages for the initial CSV files
                        max_voltages = detect_max_voltage(csv_files, voltage_column, start_row)
    
                        # Calculate the slope using linear regression
                        model = LinearRegression()
                        X = pd.DataFrame(known_impulses[:len(max_voltages)])  # Ensure known impulses match the length of max_voltages
                        y = pd.DataFrame(max_voltages)
                        model.fit(X, y)
                        slope = model.coef_[0][0]
    
                        # Print the slope
                        print("Slope value:", slope)
    
                        # Plot both graphs on the same figure
                        plt.figure(figsize=(10, 12))  # Adjust figure size
    
                        # Plot V_max vs Known Impulses in the first subplot
                        plot_vmax_vs_impulses(known_impulses[:len(max_voltages)], max_voltages, 1)
    
                        # Detect maximum voltages for the new CSV files (if different from initial)
                        new_max_voltages = detect_max_voltage(new_csv_files, voltage_column, start_row)
    
                        # Plot I_bit vs V_max in the second subplot
                        plot_ibit_vs_vmax(new_max_voltages, slope, 2)
    
                        plt.show()
                    </code>
                </pre>
            </div>

        <div class="text-container">
            <h3 class="text-2xl text-pink">Leveling System:</h3>
            <ul>
                <li>- Base of the test stand will be leveled by way of a stepper motor.</li>
                <li>- Base will be allowed to pivot through a TBD angle on nylon bushings.</li>
            </ul>
            <h2 class="text-2xl text-pink">GUI (Arduino)</h2>
            <ul>
                <li>The project entails establishing serial communication using PySerial to command an Arduino in controlling a stepper 
                    motor. Data acquisition and analysis are conducted through the NI-DAQmx Driver and PySerial, facilitating functions 
                    like sendData for transmitting motor control data and low_pass_filter for smooth speed adjustments. Measurements are 
                    converted into thrust values, ensuring accuracy by considering deflection sensitivity and a calibration force. Thrust 
                    uncertainties are estimated by scaling the standard deviation of deflection, employing reliable error propagation 
                    techniques. Calibration is achieved using the convert_to_thrust() function, which calibrates raw deflection to thrust 
                    based on a predefined calibration force and sensitivity calculation. The GUI integration involves constructing a Tkinter
                    window with intuitive elements such as clockwise/anticlockwise buttons, RPM sliders for speed adjustment, and angle 
                    indicators in degrees for user-friendly interaction and visualization.
                </li>
            </ul>
        </div>
    </div>
    <div class="text-container">
        <h3 class="text-2xl text-pink">Leveling Systems Python Code:</h3> 
        <pre class="code-box small">
            <code>
                import serial
                import serial.tools.list_ports
                import tkinter as tk
                import math
                
                def move_custom(direction, degrees):
                    global current_steps, step_counter_label, current_degrees  # Declare variables as global
                    steps_per_revolution = 200 #confirm this empirically
                    mm_per_revolution = 1.37 #confirm this empirically
                    lever_arm = 20 #inches
                    inch_to_mm = 25.4
                    degress_to_rad = math.pi/180
                    
                    steps=math.sin(degrees*degress_to_rad)*lever_arm/(mm_per_revolution/inch_to_mm)*steps_per_revolution
                    
                    if direction == 'Up':  # Check if the direction is forward
                        current_steps += steps  # Increment the current position by the number of steps
                        current_degrees +=degrees
                        command = 'A' + str(steps) + '\n'  # Command for forward movement
                    elif direction == 'Down':
                        current_steps -= steps  # Decrement the current position by the number of steps
                        current_degrees -=degrees
                        command = 'B' + str(steps) + '\n'  # Command for backward movement
                    #print(f"Sending command: {command}")  # Debug print
                    ser.write(command.encode())  # Send the command to Arduino
                    step_counter_label.config(text=f"Angular position: {current_degrees}")  # Update the step counter
                
                # Function to stop everything immediately
                def stop_all():
                    ser.write(b'S\n')  # Send the stop command to Arduino
                    ser.flush()  # Flush the serial buffer to ensure the command is sent immediately
                
                # Function to move motor to zero position
                def move_to_zero():
                    global current_steps, current_degrees  # variable global
                    if current_steps >=0:  # Check if there are steps needed to move to zero
                        command= 'B' + str(abs(current_steps)) + '\n'  # Command to move backward to zero position
                        ser.write(command.encode())
                    elif current_steps <0:
                        command= 'A' + str(abs(current_steps)) + '\n' # Command to move backward to zero position
                        ser.write(command.encode())
                    current_steps = 0  # Reset current position
                    current_degrees = 0
                    step_counter_label.config(text="Angular position: 0")  
                
                # Function to quit
                def quit_app():
                    move_to_zero() 
                    ser.close()  
                    root.quit()  
                
                # GUI setup
                def create_gui():
                    global root, current_steps, step_counter_label, current_degrees  # Declare root as a global variable
                    root = tk.Tk()
                    root.title("Stepper Motor Control")
                    current_steps = 0
                    current_degrees=0
                
                    custom_button = tk.Button(root, text="Move (degrees)", command=custom_steps)
                    custom_button.grid(row=0, columnspan=2, padx=10, pady=10)
                
                    quit_button = tk.Button(root, text="Quit", command=quit_app)
                    quit_button.grid(row=1, columnspan=2, padx=10, pady=10)
                
                    step_counter_label = tk.Label(root, text="Angular position: 0")
                    step_counter_label.grid(row=2, columnspan=2, padx=10, pady=10)
                
                    root.mainloop()
                
                # Function for custom steps input
                def custom_steps():
                    custom_window = tk.Toplevel(root)
                    custom_window.title("Move (degrees)")
                
                    direction_label = tk.Label(custom_window, text="Direction:")
                    direction_label.grid(row=0, column=0, padx=10, pady=10)
                
                    direction_var = tk.StringVar(value="Up")
                    direction_menu = tk.OptionMenu(custom_window, direction_var, "Up", "Down")
                    direction_menu.grid(row=0, column=1, padx=10, pady=10)
                
                    steps_label = tk.Label(custom_window, text="Degrees:")
                    steps_label.grid(row=1, column=0, padx=10, pady=10)
                
                    steps_entry = tk.Entry(custom_window)
                    steps_entry.grid(row=1, column=1, padx=10, pady=10)
                
                    confirm_button = tk.Button(custom_window, text="Move", command=lambda: move_custom(direction_var.get(), int(steps_entry.get())))
                    confirm_button.grid(row=2, columnspan=2, padx=10, pady=10)
                
                # Arduino port
                def get_arduino_port():
                    ports = serial.tools.list_ports.comports()
                    for port in ports:
                        if 'COM3' in port.device: 
                            return port.device
                    return None
                
                # Main
                arduino_port = get_arduino_port()
                if arduino_port:
                    ser = serial.Serial(arduino_port, baudrate=9600, timeout=1)
                    create_gui()
                else:
                    print('Arduino not found on any port!')
            </code>
        </pre>
    </div>
    
    <div class="text-container">
        <h3 class="text-2xl text-pink">Leveling Systems Arduino Code:</h3> 
        <pre class="code-box small">
            <code>
                const int stepPin = 2; // Step pin connected to Arduino digital pin 2
                const int dirPin = 3;  // Direction pin connected to Arduino digital pin 3
                const int enPin = 4; // Enable pin
                
                void setup() {
                  stepper.setMaxSpeed(3000); // Set maximum speed
                  Serial.begin(9600); // Initialize serial communication
                  digitalWrite(dirPin, HIGH);
                  //digitalWrite(4, HIGH); //LOW is on?
                }
                
                void loop() {
                  if (Serial.available() >= 2) { // Check if there are enough bytes available
                    String str = Serial.readString(); // Read the command sent from Python
                    String command = str.substring(0,1);
                    String stepsstr= str.substring(1,str.length());
                    int steps=stepsstr.toInt();
                    if (command == "A") //set dirPin based on direction input
                      digitalWrite(dirPin, HIGH);
                    if (command == "B")
                      digitalWrite(dirPin, LOW);
                    for (int i=0; i<=steps; i++) {
                      igitalWrite(stepPin, HIGH);
                      delay(1); //change the delay value to adjust motor speed
                      digitalWrite(stepPin, LOW);
                      delay(1);
                      }
                    }
                  }
            </code>
        </pre>
    </div>

    <section id="photo-album">
        <h2>Photo Album</h2>
        <div class="photo-grid">
            <div class="photo">
                <img src="assets/img/PPT_3.jpg" alt="Photo 1">
            </div>
            <div class="photo">
                <img src="assets\img\PPT_5.jpg" alt="Photo 2">
            </div>
            <div class="photo">
                <img src="assets\img\PPT_6.jpg" alt="Photo 2">
            </div>
            <div class="photo">
                <img src="assets\img\PPT_7.jpg" alt="Photo 2">
            </div>
            <div class="photo">
                <img src="assets\img\PPT_8.jpg" alt="Photo 2">
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-container">
            <nav class="foot-nav">
                <ul>
                    <li>
                        <a href="mailto:felicitycundiff@gmail.com">felicitycundiff@gmail.com</a>
                        <a href="tel:+12063533425">(206) 353-3425</a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/felicity-cundiff/">Linkedin</a>
                        <a href="https://github.com/Honeyyellowcat">Github</a>
                    </li>
                </ul>
            </nav>
        </div>
    </footer>
    

        <!---main js--->
        <script src="assets/js/codebox.js"></script>
        <script src="assets/js/photos2.js"></script>
        <script src="assets/js/tablink.js"></script>
    </body>
    </html>